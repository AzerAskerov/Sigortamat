using System;
using System.Threading.Tasks;

namespace SigortaYoxla
{
    class QuickTest
    {
        static async Task Main(string[] args)
        {
            Console.WriteLine("ğŸš€ Smart WhatsApp Test - Avtomatik TanÄ±tma");
            Console.WriteLine("==========================================\n");

            var messagingService = new MessagingService();
            
            // Test mesajÄ± yaradÄ±rÄ±q
            var message = MessagingService.CreateTestMessage("Salam! YENÄ° NÃ–MRÆ TEST - 994707877878");
            
            Console.WriteLine("ğŸ“± 994707877878 nÃ¶mrÉ™sinÉ™ mesaj gÃ¶ndÉ™rilir (tamamilÉ™ yeni nÃ¶mrÉ™)...");
            Console.WriteLine($"ğŸ“ Mesaj: {message.Text}");
            Console.WriteLine($"ğŸ•’ Vaxt: {DateTime.Now:HH:mm:ss}");
            Console.WriteLine();

            try
            {
                // Smart SendWhatsApp metodunu Ã§aÄŸÄ±rÄ±rÄ±q - avtomatik tanÄ±tma ilÉ™
                var result = await messagingService.SendWhatsAppSmartAsync(
                    message, 
                    "994707877878"
                );

                // NÉ™ticÉ™ni gÃ¶stÉ™ririk
                Console.WriteLine("ğŸ“‹ NÆTÄ°CÆ:");
                Console.WriteLine("==========");
                Console.WriteLine($"âœ… UÄŸur: {(result.Success ? "BÉ™li" : "Xeyr")}");
                Console.WriteLine($"ğŸ“± Kanal: {result.Channel}");
                Console.WriteLine($"ğŸ“ NÃ¶mrÉ™: {result.Recipient}");
                Console.WriteLine($"ğŸ†” ID: {result.MessageId}");
                Console.WriteLine($"ğŸ•’ GÃ¶ndÉ™rilmÉ™ vaxtÄ±: {result.SentAt:dd.MM.yyyy HH:mm:ss}");
                
                if (!result.Success)
                {
                    Console.WriteLine($"âŒ XÉ™ta: {result.Error}");
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"âŒ Exception baÅŸ verdi: {ex.Message}");
            }

            Console.WriteLine("\nâœ… Test tamamlandÄ±! Enter basÄ±n...");
            Console.ReadLine();
        }
    }
}
