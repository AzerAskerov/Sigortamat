using System;
using System.Threading.Tasks;

namespace SigortaYoxla
{
    class QuickTest
    {
        static async Task Main(string[] args)
        {
            Console.WriteLine("🚀 Smart WhatsApp Test - Avtomatik Tanıtma");
            Console.WriteLine("==========================================\n");

            var messagingService = new MessagingService();
            
            // Test mesajı yaradırıq
            var message = MessagingService.CreateTestMessage("Salam! YENİ NÖMRƏ TEST - 994707877878");
            
            Console.WriteLine("📱 994707877878 nömrəsinə mesaj göndərilir (tamamilə yeni nömrə)...");
            Console.WriteLine($"📝 Mesaj: {message.Text}");
            Console.WriteLine($"🕒 Vaxt: {DateTime.Now:HH:mm:ss}");
            Console.WriteLine();

            try
            {
                // Smart SendWhatsApp metodunu çağırırıq - avtomatik tanıtma ilə
                var result = await messagingService.SendWhatsAppSmartAsync(
                    message, 
                    "994707877878"
                );

                // Nəticəni göstəririk
                Console.WriteLine("📋 NƏTİCƏ:");
                Console.WriteLine("==========");
                Console.WriteLine($"✅ Uğur: {(result.Success ? "Bəli" : "Xeyr")}");
                Console.WriteLine($"📱 Kanal: {result.Channel}");
                Console.WriteLine($"📞 Nömrə: {result.Recipient}");
                Console.WriteLine($"🆔 ID: {result.MessageId}");
                Console.WriteLine($"🕒 Göndərilmə vaxtı: {result.SentAt:dd.MM.yyyy HH:mm:ss}");
                
                if (!result.Success)
                {
                    Console.WriteLine($"❌ Xəta: {result.Error}");
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"❌ Exception baş verdi: {ex.Message}");
            }

            Console.WriteLine("\n✅ Test tamamlandı! Enter basın...");
            Console.ReadLine();
        }
    }
}
